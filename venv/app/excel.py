import xlwings as xw
import string


精大稀=["836-079","836-092","836-095","836-143","836-168"]
数控设备=["836-039","836-040","836-047","836-048","836-077","836-134","836-135","836-136","836-137","836-111","947-080","947-168","947-169","947-170","836-163","323-047","323-048","323-037","323-025","323-045","323-046","323-032","323-039","323-041","323-042","323-043","323-044","122-074","122-120","122-124","122-125","122-141","947-069","836-162","122-138","836-026","122-049","122-058","122-071","836-036","122-119","122-111","836-049","122-118","836-078","122-101","122-040","836-079","836-059","836-060","836-061","836-062","836-063","836-070","836-075","836-076","836-130","836-131","836-132","836-133","947-165","947-166","947-167","836-092","836-080","836-081","836-082","836-083","836-084","836-085","836-086","836-087","836-088","836-089","836-090","836-091","947-096","947-097","836-095","836-096","836-097","836-098","836-099","836-100","836-101","836-102","836-103","836-104","836-105","836-106","836-107","947-129","836-108","836-143","836-144","836-145","836-146","836-147","836-148","836-149","836-150","836-151","836-152","836-153","836-154","836-155","836-156","836-157","836-158","836-159","836-160","836-161","947-171","947-172","947-173","836-168","836-169","836-170","836-171","836-172","836-173","836-174","836-175","836-176","836-177","836-178","836-179","836-180","836-181","836-182","836-183","836-184","836-185","836-186","947-186","947-187","947-188"]
关键设备=["836-039","836-040","836-047","836-048","836-077","836-134","836-135","836-136","836-137","836-111","836-163","323-047","323-048","323-037","323-025","323-045","323-046","323-032","122-074","122-120","122-124","122-125","122-141","947-069","836-162","122-138","836-026","122-049","122-058","122-071","836-036","122-119","122-111","836-049","122-118","836-078","122-101","122-040","836-079","836-092","836-095","836-143","836-168"]
锻压设备=["122-074","122-120","122-124","122-125","122-141","122-138","122-049","122-058","122-071","122-119","122-111","122-118","122-101","122-040"]
铸造设备=["323-047","323-048","323-037","323-025","323-045","323-046","323-032","323-039","323-041","323-042","323-043","323-044"]
热处理设备=["836-039","836-040","836-047","836-048","836-077","836-134","836-135","836-136","836-137","836-111","836-041","836-042","836-045","836-052","836-053","836-138","836-139","836-140","836-141","836-142","836-166","836-163","836-025","836-037","836-046","836-165","836-162","836-026","836-036","836-049","836-078","836-079","836-059","836-060","836-061","836-062","836-063","836-070","836-075","836-076","836-130","836-131","836-132","836-133","836-092","836-080","836-081","836-082","836-083","836-084","836-085","836-086","836-087","836-088","836-089","836-090","836-091","836-095","836-096","836-097","836-098","836-099","836-100","836-101","836-102","836-103","836-104","836-105","836-106","836-107","836-108","836-143","836-144","836-145","836-146","836-147","836-148","836-149","836-150","836-151","836-152","836-153","836-154","836-155","836-156","836-157","836-158","836-159","836-160","836-161","836-168","836-169","836-170","836-171","836-172","836-173","836-174","836-175","836-176","836-177","836-178","836-179","836-180","836-181","836-182","836-183","836-184","836-185","836-186"]
其他设备=["947-080","947-168","947-169","947-170","947-069","947-165","947-166","947-167","947-096","947-097","947-129","947-171","947-172","947-173","947-186","947-187","947-188","569-027","569-041"]



# app=xw.App(visible=True,add_book=False)

filepath =r"F:\py workplace\aa\venv\app\2018年01维修情况.xls"
book=xw.Book(filepath)
book.activate()
sheet=xw.Sheet("工单列表")
sheet.activate()
data =xw.Range("A1:H2000").value

精大稀故障时间=0
数控设备故障时间=0
关键设备故障时间=0
锻压设备故障时间=0
铸造设备故障时间=0
热处理设备故障时间=0
其他设备故障时间=0
isinlist=False




# 遍历维修情况
for id,工单号,设备编号,报修日期,状态,故障原因,修复情况,维修时间 in data:
    isinlist = False
    if not id and not 维修时间:
        break
    if(设备编号 in 精大稀 or str(设备编号).lower().replace("w","-") in 精大稀):
        if not isinlist:
            isinlist = True
        精大稀故障时间=精大稀故障时间+int(维修时间)
    if (设备编号 in 数控设备 or str(设备编号).lower().replace("w", "-") in 数控设备):
        if not isinlist:
            isinlist = True
        数控设备故障时间 = 数控设备故障时间 + int(维修时间)
    if (设备编号 in 关键设备 or str(设备编号).lower().replace("w", "-") in 关键设备):
        if not isinlist:
            isinlist = True
        关键设备故障时间 = 关键设备故障时间 + int(维修时间)
    if (设备编号 in 锻压设备 or str(设备编号).lower().replace("w", "-") in 锻压设备):
        if not isinlist:
            isinlist = True
        锻压设备故障时间 = 锻压设备故障时间 + int(维修时间)
    if (设备编号 in 铸造设备 or str(设备编号).lower().replace("w", "-") in 铸造设备):
        if not isinlist:
            isinlist = True
        铸造设备故障时间 = 铸造设备故障时间 + int(维修时间)
    if (设备编号 in 热处理设备 or str(设备编号).lower().replace("w", "-") in 热处理设备):
        if not isinlist:
            isinlist = True
        热处理设备故障时间 = 热处理设备故障时间 + int(维修时间)
    if (设备编号 in 其他设备 or str(设备编号).lower().replace("w", "-") in 其他设备):
        if not isinlist:
            isinlist = True
        其他设备故障时间 = 其他设备故障时间 + int(维修时间)
    if not isinlist:
        print(id, 工单号, 设备编号, 报修日期, 状态, 故障原因, 修复情况, 维修时间)
    #print(id,工单号,设备编号,报修日期,状态,故障原因,修复情况,维修时间)
print(精大稀故障时间,数控设备故障时间,关键设备故障时间,锻压设备故障时间,铸造设备故障时间,热处理设备故障时间,其他设备故障时间)














# rng=xw.Range('A:A').expand('down')
#
#
#
# nrows=rng.rows.count
#
# ncols=rng.columns.count
# print(ncols)
# print(nrows)





